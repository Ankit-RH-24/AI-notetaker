<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>MedNote - Record & Transcribe</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;800&display=swap" rel="stylesheet">
  <style>
    body {
      font-family: 'Inter', sans-serif;
    }

    .mic-pulse {
      animation: pulse 1s infinite;
    }

    @keyframes pulse {
      0% { box-shadow: 0 0 0 0 rgba(239, 68, 68, 0.5); }
      70% { box-shadow: 0 0 0 15px rgba(239, 68, 68, 0); }
      100% { box-shadow: 0 0 0 0 rgba(239, 68, 68, 0); }
    }

    .fade-in {
      animation: fadeIn 0.8s ease-in-out both;
    }

    @keyframes fadeIn {
      0% { opacity: 0; transform: translateY(10px); }
      100% { opacity: 1; transform: translateY(0); }
    }
  </style>
  
</head>
<body class="relative bg-gradient-to-br from-blue-100 via-white to-cyan-100 min-h-screen flex items-center justify-center px-4 py-12 overflow-hidden">
  <a href="/login" class="absolute top-4 right-4 text-sm text-blue-700 hover:underline">Login</a>

  <!-- 🔓 Logout Button -->
  <button id="logoutBtn" onclick="logoutUser()"
    class="hidden absolute top-4 right-4 bg-red-500 text-white text-sm px-4 py-2 rounded hover:bg-red-600">
    Logout
  </button>



  <!-- 🌐 Floating Blob Background -->
  <svg class="absolute top-[-100px] left-[-100px] blur-3xl opacity-20 w-[600px] h-[600px] z-0" viewBox="0 0 200 200" xmlns="http://www.w3.org/2000/svg">
    <path fill="#93c5fd" d="M56.8,-64.1C70.2,-50.1,76.4,-28.4,73.9,-10.6C71.5,7.1,60.4,21.9,48.1,32.3C35.9,42.7,22.6,48.6,8.4,54.8C-5.8,61,-20.9,67.5,-34.3,63.2C-47.7,58.8,-59.4,43.6,-65.5,26.6C-71.6,9.6,-72,-9.2,-64.2,-23.3C-56.4,-37.4,-40.5,-46.8,-24.9,-58.1C-9.3,-69.5,6,-82.8,21.5,-83.5C37.1,-84.2,55.4,-72.4,56.8,-64.1Z" transform="translate(100 100)" />
  </svg>

  <!-- 🌈 Gradient Outer Card -->
  <div class="p-1 rounded-3xl bg-gradient-to-br from-purple-500 via-blue-500 to-cyan-500 shadow-xl z-10 fade-in">
    <div class="w-full max-w-3xl bg-white/80 backdrop-blur-lg shadow-2xl rounded-2xl p-8 hover:shadow-[0_0_60px_rgba(147,197,253,0.4)] transition-shadow duration-500">
      <h1 class="text-4xl font-extrabold text-blue-700 text-center mb-1 drop-shadow-sm">📝 MedNote</h1>
      <p class="text-center text-gray-500 mb-8 text-sm sm:text-base">Secure voice-to-text for medical professionals</p>

      <textarea id="transcript"
        placeholder="Transcript will appear here..."
        class="w-full h-48 p-4 rounded-lg border border-gray-300 shadow-inner focus:outline-none focus:ring-2 focus:ring-blue-400 resize-none text-gray-800 bg-white/90 mb-6 placeholder-gray-400"
      ></textarea>

      <div class="flex flex-wrap justify-center gap-4">
        <button id="recordBtn"
          class="bg-blue-600 text-white px-6 py-3 rounded-md hover:bg-blue-700 transition flex items-center gap-2">
          <span id="micIcon">🎤</span>
          <span id="recordLabel">Start Recording</span>
        </button>

        <button id="saveBtn"
          class="bg-green-600 text-white px-6 py-3 rounded-md hover:bg-green-700 transition">
          💾 Save Transcript
        </button>

        <button onclick="window.location='/saved'"
          class="bg-gray-700 text-white px-6 py-3 rounded-md hover:bg-gray-800 transition">
          📂 View Saved
        </button>
      </div>
    </div>
  </div>

  <!-- 🎙️ Mic Toggle Script -->
  <script src="/static/app.js"></script>
  <script>
    const recordBtn = document.getElementById("recordBtn");
    const micIcon = document.getElementById("micIcon");
    const recordLabel = document.getElementById("recordLabel");

    let isRecording = false;

    recordBtn.addEventListener("click", () => {
      isRecording = !isRecording;
      if (isRecording) {
        recordBtn.classList.add("mic-pulse");
        micIcon.textContent = "🔴";
        recordLabel.textContent = "Stop Recording";
      } else {
        recordBtn.classList.remove("mic-pulse");
        micIcon.textContent = "🎤";
        recordLabel.textContent = "Start Recording";
      }
    });
    
  </script>
  <script src="https://www.gstatic.com/firebasejs/10.12.2/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/10.12.2/firebase-auth-compat.js"></script>
<script>
  const firebaseConfig = {
    apiKey: "AIzaSyAh7ncrXf5tIic4fDfTrVlbrmWef6xSov8",
    authDomain: "otp-login-ca063.firebaseapp.com",
    projectId: "otp-login-ca063",
    storageBucket: "otp-login-ca063.appspot.com",
    messagingSenderId: "380756162522",
    appId: "1:380756162522:web:default"
  };
  firebase.initializeApp(firebaseConfig);

  const logoutBtn = document.getElementById('logoutBtn');

  firebase.auth().onAuthStateChanged(user => {
    if (user) {
      logoutBtn.classList.remove("hidden");
    } else {
      logoutBtn.classList.add("hidden");
    }
  });

  function logoutUser() {
    firebase.auth().signOut().then(() => {
      alert("Logged out!");
      window.location.href = "/login";
    });
  }
</script>
</body>
</html>
